<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Maestro-sign-in">
  <meta name="author" content="BSH">
  <title>Maestro::sign-in</title>

  <link href="{{url_for('static', path='/css/bootstrap.min.css')}}" rel="stylesheet">
  <link href="{{url_for('static', path='/css/sign-form.css')}}" rel="stylesheet">
  <link rel="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">

  <meta name="theme-color" content="#82c96b">

</head>

<body class="text-center">

  <main class="standard-form w-100 m-auto">
    <form action="/" method="get">
      <a href="/" class="Maestro-logo">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-file-music"
          viewBox="0 0 16 16">
          <path
            d="M10.304 3.13a1 1 0 0 1 1.196.98v1.8l-2.5.5v5.09c0 .495-.301.883-.662 1.123C7.974 12.866 7.499 13 7 13c-.5 0-.974-.134-1.338-.377-.36-.24-.662-.628-.662-1.123s.301-.883.662-1.123C6.026 10.134 6.501 10 7 10c.356 0 .7.068 1 .196V4.41a1 1 0 0 1 .804-.98l1.5-.3z">
          </path>
          <path
            d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z">
          </path>
        </svg>
        <strong>Maestro</strong>
      </a>
    </form>

      <h3 class="display2">Sign in</h3>
        <form name="form_ex" class="margin-top-20" action="/index" method="post" enctype="multipart/form-data">
          <div class="form-floating">
            <input type="email" name="user_email" class="form-control" id="user_email" placeholder="name@example.com">
            <label for="floatingInput">Email address</label>
          </div>
          <div class="form-floating">
            <input type="password" name="user_pwd" class="form-control" id="password_check" placeholder="Password">
            <label for="floatingPassword">Password</label>
            <div class="eyes">
              <i class="fa fa-eye fa-lg"></i>
            </div>
          </div>

          <p><input type="submit" value="Sign in" class="submit-btn w-100 btn btn-lg btn-primary">
          </p>

          <p class="text-4 text-muted">Don't have an account? <a href="/sign-up">sign up</a>.</p>
        </form>
  </main>

  <script src="{{url_for('static', path='/js/sign.js')}}"></script>

  <script>
    const form = document.querySelector('#sign-in-form');
    form.addEventListener('submit', (event) => {
      event.preventDefault();
      const userEmail = document.querySelector('#user-email').value;
      const userPassword = document.querySelector('#password_check').value;

      fetch('/checkpw', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ user_email: userEmail, password_check: userPassword }),
      })
        .then((response) => response.json())
        .then((data) => {
          if (data.result) {
            document.submitFrm.submit();
          } else {
            alert('패스워드가 일치하지 않습니다.');
            return false;
          }
        });
    });

  </script>

</body>

</html>